<div align="center">
<h1><%= @site.name %></h1>
</div>

<div align="right">
  <%= link_to sites_path, class: 'btn btn-default' do %>
    <span class="glyphicon glyphicon-list-alt"></span>
    Back
  <% end %>
  <%= link_to edit_site_path(@site), class: 'btn btn-primary' do %>
    <span class="glyphicon glyphicon-pencil"></span>
    Edit
  <% end %>
</div>

<script type="text/javascript" charset="utf-8">

  $(function() {
    new Highcharts.Chart({
      chart: {renderTo: "URLs"},
      title: {text: "Insight Scores"},
      xAxis: {type: "datetime"},
      yAxis: {title: {text: "(n/100)"}},
      series: [{
        name: 'Mobile Speed',
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= 3.weeks.ago.to_i * 1000 %>,
        data: [10, 10, 10, 10, <%= @mobile.speed %>]
      }, {
        name: 'Mobile UX',
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= 3.weeks.ago.to_i * 1000 %>,
        data: [10, 10, 10, 10, <%= @mobile.usability %>]
      }, {
        name: 'Desktop Speed',
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= 3.weeks.ago.to_i * 1000 %>,
        data: [10, 10, 10, 10, <%= @desktop.speed %>]
      }],
    });
  });

  $(function () {
    new Highcharts.Chart({

        chart: {
          renderTo: "Guage",
          type: 'gauge',
          plotBackgroundColor: null,
          plotBackgroundImage: null,
          plotBorderWidth: 0,
          plotShadow: false
        },

        title: {
          text: 'Load Time'
        },

        pane: {
          startAngle: -150,
          endAngle: 150,
          background: [{
            backgroundColor: {
              linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
              stops: [
                [0, '#FFF'],
                [1, '#333']
              ]
            },
            borderWidth: 0,
            outerRadius: '109%'
          }, {
            backgroundColor: {
              linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
              stops: [
                [0, '#333'],
                [1, '#FFF']
              ]
            },
            borderWidth: 1,
            outerRadius: '107%'
          }, {
            // default background
          }, {
            backgroundColor: '#DDD',
            borderWidth: 0,
            outerRadius: '105%',
            innerRadius: '103%'
          }]
        },

        // the value axis
        yAxis: {
          min: 0,
          max: 10000,

          minorTickInterval: '0',
          minorTickWidth: 1,
          minorTickLength: 10,
          minorTickPosition: 'inside',
          minorTickColor: '#666',

          tickPixelInterval: 30,
          tickWidth: 2,
          tickPosition: 'inside',
          tickLength: 10,
          tickColor: '#666',
          labels: {
            step: 2,
            rotation: 'auto'
          },
          title: {
            text: 'milliseconds'
          },
          plotBands: [{
            from: 0,
            to: 1000,
            color: '#55BF3B' // green
          }, {
            from: 1000,
            to: 4000,
            color: '#DDDF0D' // yellow
          }, {
            from: 4000,
            to: 10000,
            color: '#DF5353' // red
          }]
        },

        series: [{
          name: 'Load Time',
          data: [8000],
          tooltip: {
            valueSuffix: 'ms'
          }
        }]
      });
  });


</script>




<div id="URLs" align="center"></div>
<div id="Guage" align="center"></div>
<div id="URLs" align="center"></div>
<br>

<div class="table-responsive">
  <table class="table table-striped table-bordered table-hover">
    <thead>
    <tr>
      <th>Date</th>
      <th>Desktop Speed</th>
      <th>Mobile Speed</th>
      <th>Mobile Usability</th>
    </tr>
    </thead>

    <tbody>
    <% @site.webstats.each_with_index do |stat, index| %>
      <tr>
        <td><%= stat.pull_date.getlocal.strftime("%m/%d/%Y") %></td>
        <td class='<%= up_down(stat.desktop_score, @site.webstats[index - 1].try(:desktop_score)) %>'><%= stat.desktop_score %></td>
        <td><%= stat.mobile_score %></td>
        <td><%= stat.mobile_usability %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>
